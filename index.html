<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Fast World Courier</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        navy: { 900: '#0B0F17', 800: '#111827', 700: '#1F2937' },
                        gold: { 400: '#D4A23A', 500: '#C4942E' },
                        cream: '#F5F5F0',
                    }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Inter', system-ui, sans-serif; background-color: #0B0F17; color: #F5F5F0; }
        input:focus, select:focus, textarea:focus { outline: none; border-color: #D4A23A; box-shadow: 0 0 0 3px rgba(212, 162, 58, 0.1); }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0B0F17; }
        ::-webkit-scrollbar-thumb { background: #D4A23A; border-radius: 4px; }
    </style>
</head>
<body class="antialiased">
    <!-- Admin Header -->
    <header class="bg-navy-800 border-b border-gold-400/20 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-gold-400 rounded-lg flex items-center justify-center">
                        <i data-lucide="package" class="w-5 h-5 text-navy-900"></i>
                    </div>
                    <h1 class="text-xl font-bold text-cream">Admin Panel</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <span class="text-sm text-cream/60">Fast World Courier</span>
                    <a href="index.html" class="flex items-center px-4 py-2 text-sm text-cream/70 hover:text-gold-400 transition-colors">
                        <i data-lucide="log-out" class="w-4 h-4 mr-2"></i>
                        Exit
                    </a>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Stats -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8" id="stats-container">
            <div class="bg-navy-800 border border-gold-400/20 rounded-xl p-4">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-cream/60">Total Shipments</p>
                        <p class="text-2xl font-bold text-cream" id="stat-total">0</p>
                    </div>
                    <i data-lucide="bar-chart-3" class="w-8 h-8 text-gold-400/50"></i>
                </div>
            </div>
            <div class="bg-navy-800 border border-gold-400/20 rounded-xl p-4">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-cream/60">In Transit</p>
                        <p class="text-2xl font-bold text-gold-400" id="stat-transit">0</p>
                    </div>
                    <i data-lucide="truck" class="w-8 h-8 text-gold-400/50"></i>
                </div>
            </div>
            <div class="bg-navy-800 border border-gold-400/20 rounded-xl p-4">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-cream/60">Delivered</p>
                        <p class="text-2xl font-bold text-green-400" id="stat-delivered">0</p>
                    </div>
                    <i data-lucide="check-circle" class="w-8 h-8 text-green-400/50"></i>
                </div>
            </div>
            <div class="bg-navy-800 border border-gold-400/20 rounded-xl p-4">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-cream/60">Pending</p>
                        <p class="text-2xl font-bold text-blue-400" id="stat-pending">0</p>
                    </div>
                    <i data-lucide="clock" class="w-8 h-8 text-blue-400/50"></i>
                </div>
            </div>
        </div>

        <!-- Actions Bar -->
        <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6">
            <div class="relative flex-1 max-w-md">
                <i data-lucide="search" class="absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-cream/40"></i>
                <input type="text" id="search-input" placeholder="Search by tracking number or name..."
                    class="w-full pl-10 pr-4 py-2 bg-navy-800 border border-gold-400/30 rounded-lg text-cream placeholder-cream/30 focus:border-gold-400 transition-colors">
            </div>
            <button onclick="openCreateModal()" class="flex items-center px-4 py-2 bg-gold-400 text-navy-900 font-semibold rounded-lg hover:bg-gold-500 transition-colors">
                <i data-lucide="plus" class="w-5 h-5 mr-2"></i>
                New Shipment
            </button>
        </div>

        <!-- Shipments Table -->
        <div class="bg-navy-800 border border-gold-400/20 rounded-xl overflow-hidden">
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead class="bg-navy-900/50 border-b border-gold-400/20">
                        <tr>
                            <th class="text-left px-6 py-4 text-sm font-semibold text-cream">Tracking #</th>
                            <th class="text-left px-6 py-4 text-sm font-semibold text-cream">Recipient</th>
                            <th class="text-left px-6 py-4 text-sm font-semibold text-cream">Route</th>
                            <th class="text-left px-6 py-4 text-sm font-semibold text-cream">Status</th>
                            <th class="text-left px-6 py-4 text-sm font-semibold text-cream">Created</th>
                            <th class="text-right px-6 py-4 text-sm font-semibold text-cream">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="shipments-table" class="divide-y divide-gold-400/10">
                        <!-- Populated by JS -->
                    </tbody>
                </table>
            </div>
        </div>
    </main>

    <!-- Create Shipment Modal -->
    <div id="create-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden items-center justify-center p-4">
        <div class="bg-navy-800 border border-gold-400/20 rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b border-gold-400/20 flex items-center justify-between">
                <h2 class="text-xl font-bold text-cream">Create New Shipment</h2>
                <button onclick="closeCreateModal()" class="text-cream/60 hover:text-cream">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>
            <form id="create-form" class="p-6 space-y-4">
                <div class="grid md:grid-cols-2 gap-4">
                    <input type="text" name="senderName" placeholder="Sender Name *" required
                        class="px-4 py-2 bg-navy-900 border border-gold-400/30 rounded-lg text-cream placeholder-cream/30 focus:border-gold-400">
                    <input type="email" name="senderEmail" placeholder="Sender Email *" required
                        class="px-4 py-2 bg-navy-900 border border-gold-400/30 rounded-lg text-cream placeholder-cream/30 focus:border-gold-400">
                    <input type="text" name="recipientName" placeholder="Recipient Name *" required
                        class="px-4 py-2 bg-navy-900 border border-gold-400/30 rounded-lg text-cream placeholder-cream/30 focus:border-gold-400">
                    <input type="email" name="recipientEmail" placeholder="Recipient Email *" required
                        class="px-4 py-2 bg-navy-900 border border-gold-400/30 rounded-lg text-cream placeholder-cream/30 focus:border-gold-400">
                    <input type="text" name="origin" placeholder="Origin *" required
                        class="px-4 py-2 bg-navy-900 border border-gold-400/30 rounded-lg text-cream placeholder-cream/30 focus:border-gold-400">
                    <input type="text" name="destination" placeholder="Destination *" required
                        class="px-4 py-2 bg-navy-900 border border-gold-400/30 rounded-lg text-cream placeholder-cream/30 focus:border-gold-400">
                    <input type="text" name="weight" placeholder="Weight (e.g., 25 kg) *" required
                        class="px-4 py-2 bg-navy-900 border border-gold-400/30 rounded-lg text-cream placeholder-cream/30 focus:border-gold-400">
                    <select name="service" class="px-4 py-2 bg-navy-900 border border-gold-400/30 rounded-lg text-cream focus:border-gold-400">
                        <option value="express">Express</option>
                        <option value="standard">Standard</option>
                        <option value="economy">Economy</option>
                    </select>
                </div>
                <div class="flex justify-end gap-3 pt-4">
                    <button type="button" onclick="closeCreateModal()" class="px-4 py-2 text-cream/70 hover:text-cream transition-colors">Cancel</button>
                    <button type="submit" class="px-6 py-2 bg-gold-400 text-navy-900 font-semibold rounded-lg hover:bg-gold-500 transition-colors">Create Shipment</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Shipment Details Modal -->
    <div id="details-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden items-center justify-center p-4">
        <div class="bg-navy-800 border border-gold-400/20 rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b border-gold-400/20 flex items-center justify-between">
                <h3 class="text-xl font-bold text-cream">Shipment Details</h3>
                <button onclick="closeDetailsModal()" class="text-cream/60 hover:text-cream">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>
            <div id="details-content" class="p-6 space-y-6">
                <!-- Populated by JS -->
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();

        let shipments = JSON.parse(localStorage.getItem('fastworld_shipments') || '[]');

        const statusLabels = {
            'label_created': 'Label Created',
            'picked_up': 'Picked Up',
            'in_transit': 'In Transit',
            'customs': 'In Customs',
            'out_for_delivery': 'Out for Delivery',
            'delivered': 'Delivered',
            'exception': 'Exception'
        };

        const statusColors = {
            'label_created': 'bg-gray-500',
            'picked_up': 'bg-blue-500',
            'in_transit': 'bg-gold-400',
            'customs': 'bg-purple-500',
            'out_for_delivery': 'bg-green-500',
            'delivered': 'bg-green-600',
            'exception': 'bg-red-500'
        };

        function generateTrackingNumber() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let result = 'FWC-';
            for (let i = 0; i < 10; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        function updateStats() {
            document.getElementById('stat-total').textContent = shipments.length;
            document.getElementById('stat-transit').textContent = shipments.filter(s => s.status === 'in_transit').length;
            document.getElementById('stat-delivered').textContent = shipments.filter(s => s.status === 'delivered').length;
            document.getElementById('stat-pending').textContent = shipments.filter(s => ['label_created', 'picked_up'].includes(s.status)).length;
        }

        function renderShipments(searchTerm = '') {
            const tbody = document.getElementById('shipments-table');
            const filtered = shipments.filter(s => 
                s.trackingNumber.toLowerCase().includes(searchTerm.toLowerCase()) ||
                s.recipientName.toLowerCase().includes(searchTerm.toLowerCase())
            );

            if (filtered.length === 0) {
                tbody.innerHTML = `<tr><td colspan="6" class="px-6 py-12 text-center text-cream/50">No shipments found. Create your first shipment to get started.</td></tr>`;
                return;
            }

            tbody.innerHTML = filtered.map(shipment => `
                <tr class="hover:bg-navy-900/30 transition-colors">
                    <td class="px-6 py-4">
                        <div class="flex items-center space-x-2">
                            <span class="font-mono text-gold-400">${shipment.trackingNumber}</span>
                            <button onclick="copyToClipboard('${shipment.trackingNumber}')" class="p-1 hover:bg-gold-400/10 rounded transition-colors" title="Copy">
                                <i data-lucide="copy" class="w-4 h-4 text-cream/50"></i>
                            </button>
                        </div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-cream">${shipment.recipientName}</div>
                        <div class="text-sm text-cream/50">${shipment.recipientEmail}</div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-sm text-cream">${shipment.origin} → ${shipment.destination}</div>
                        <div class="text-xs text-cream/50">${shipment.weight} • ${shipment.service}</div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="flex items-center space-x-2">
                            <span class="w-2 h-2 rounded-full ${statusColors[shipment.status]}"></span>
                            <span class="text-sm text-cream">${statusLabels[shipment.status]}</span>
                        </div>
                    </td>
                    <td class="px-6 py-4 text-sm text-cream/70">${new Date(shipment.createdAt).toLocaleDateString()}</td>
                    <td class="px-6 py-4">
                        <div class="flex items-center justify-end space-x-2">
                            <select onchange="updateStatus('${shipment.id}', this.value)"
                                class="text-sm bg-navy-900 border border-gold-400/30 rounded px-2 py-1 text-cream focus:border-gold-400">
                                ${Object.entries(statusLabels).map(([value, label]) => 
                                    `<option value="${value}" ${shipment.status === value ? 'selected' : ''}>${label}</option>`
                                ).join('')}
                            </select>
                            <button onclick="showDetails('${shipment.id}')" class="p-2 hover:bg-gold-400/10 rounded-lg transition-colors" title="View details">
                                <i data-lucide="chevron-down" class="w-4 h-4 text-cream/50"></i>
                            </button>
                            <button onclick="deleteShipment('${shipment.id}')" class="p-2 hover:bg-red-500/10 rounded-lg transition-colors" title="Delete">
                                <i data-lucide="trash-2" class="w-4 h-4 text-red-400"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
            
            lucide.createIcons();
        }

        function openCreateModal() {
            document.getElementById('create-modal').classList.remove('hidden');
            document.getElementById('create-modal').classList.add('flex');
        }

        function closeCreateModal() {
            document.getElementById('create-modal').classList.add('hidden');
            document.getElementById('create-modal').classList.remove('flex');
            document.getElementById('create-form').reset();
        }

        function showDetails(id) {
            const shipment = shipments.find(s => s.id === id);
            if (!shipment) return;

            document.getElementById('details-content').innerHTML = `
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <p class="text-sm text-cream/60 mb-1">Tracking Number</p>
                        <p class="text-lg font-mono text-gold-400">${shipment.trackingNumber}</p>
                    </div>
                    <div>
                        <p class="text-sm text-cream/60 mb-1">Status</p>
                        <p class="text-lg text-cream">${statusLabels[shipment.status]}</p>
                    </div>
                </div>
                <div class="grid md:grid-cols-2 gap-4">
                    <div class="bg-navy-900/50 rounded-lg p-4">
                        <p class="text-sm text-gold-400 mb-2">Sender</p>
                        <p class="text-cream font-medium">${shipment.senderName}</p>
                        <p class="text-sm text-cream/60">${shipment.senderEmail}</p>
                    </div>
                    <div class="bg-navy-900/50 rounded-lg p-4">
                        <p class="text-sm text-gold-400 mb-2">Recipient</p>
                        <p class="text-cream font-medium">${shipment.recipientName}</p>
                        <p class="text-sm text-cream/60">${shipment.recipientEmail}</p>
                    </div>
                </div>
                <div>
                    <p class="text-sm text-cream/60 mb-2">Tracking History</p>
                    <div class="space-y-3">
                        ${shipment.events.map((event, idx) => `
                            <div class="flex items-start space-x-3 text-sm">
                                <i data-lucide="check-circle" class="w-4 h-4 text-gold-400 mt-0.5"></i>
                                <div>
                                    <p class="text-cream">${event.status}</p>
                                    <p class="text-cream/50">${event.location} • ${event.date} ${event.time}</p>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            document.getElementById('details-modal').classList.remove('hidden');
            document.getElementById('details-modal').classList.add('flex');
            lucide.createIcons();
        }

        function closeDetailsModal() {
            document.getElementById('details-modal').classList.add('hidden');
            document.getElementById('details-modal').classList.remove('flex');
        }

        function updateStatus(id, newStatus) {
            const shipment = shipments.find(s => s.id === id);
            if (shipment) {
                const now = new Date();
                shipment.status = newStatus;
                shipment.events.unshift({
                    date: now.toLocaleDateString(),
                    time: now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                    location: shipment.destination,
                    status: statusLabels[newStatus],
                    completed: true
                });
                saveShipments();
                updateStats();
                renderShipments(document.getElementById('search-input').value);
            }
        }

        function deleteShipment(id) {
            if (confirm('Are you sure you want to delete this shipment?')) {
                shipments = shipments.filter(s => s.id !== id);
                saveShipments();
                updateStats();
                renderShipments(document.getElementById('search-input').value);
            }
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text);
        }

        function saveShipments() {
            localStorage.setItem('fastworld_shipments', JSON.stringify(shipments));
        }

        document.getElementById('create-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const now = new Date();
            
            const newShipment = {
                id: Math.random().toString(36).substr(2, 9),
                trackingNumber: generateTrackingNumber(),
                senderName: formData.get('senderName'),
                senderEmail: formData.get('senderEmail'),
                recipientName: formData.get('recipientName'),
                recipientEmail: formData.get('recipientEmail'),
                origin: formData.get('origin'),
                destination: formData.get('destination'),
                weight: formData.get('weight'),
                service: formData.get('service'),
                status: 'label_created',
                createdAt: now.toISOString(),
                estimatedDelivery: new Date(now.getTime() + 5 * 24 * 60 * 60 * 1000).toLocaleDateString(),
                events: [{
                    date: now.toLocaleDateString(),
                    time: now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                    location: formData.get('origin'),
                    status: 'Label created',
                    completed: true
                }]
            };

            shipments.unshift(newShipment);
            saveShipments();
            updateStats();
            renderShipments();
            closeCreateModal();
        });

        document.getElementById('search-input').addEventListener('input', (e) => {
            renderShipments(e.target.value);
        });

        // Initialize
        updateStats();
        renderShipments();
    </script>
</body>
</html>
